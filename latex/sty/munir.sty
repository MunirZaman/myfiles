% Package munir.sty

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{munir}

% packages

%amsmath
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsfonts}
\RequirePackage{amsthm}

\RequirePackage{tcolorbox}
\RequirePackage[framemethod=TikZ]{mdframed} 
\RequirePackage{thmtools}
\RequirePackage[colorlinks=true]{hyperref}

\RequirePackage{xcolor}
\RequirePackage{ifthen}

% hyperref setup
\hypersetup{urlcolor=RubineRed,linkcolor=RoyalBlue,citecolor=ForestGreen}

% tikz
\RequirePackage{tikz}
\usetikzlibrary{arrows.meta}

% macros
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\ol}{\overline}
\newcommand{\ul}{\underline}
\newcommand{\dg}{^\circ} %% degree
\newcommand{\ii}{\item}

%Inequalities
\newcommand{\cycsum}{\sum_{\mathrm{cyc}}}
\newcommand{\symsum}{\sum_{\mathrm{sym}}}
\newcommand{\cycprod}{\prod_{\mathrm{cyc}}}
\newcommand{\symprod}{\prod_{\mathrm{sym}}}

%Geometry
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\dang}{\measuredangle} %% Directed angle
\newcommand{\ray}[1]{\overrightarrow{#1}}
\newcommand{\seg}[1]{\overline{#1}}
\newcommand{\arc}[1]{\wideparen{#1}}

% number theory
\DeclareMathOperator{\ord}{ord}

% sets
\newcommand{\CC}{\mathbb C}
\newcommand{\NN}{\mathbb N}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\ZZ}{\mathbb Z}


% Fancy section and chapter heads. Thx evan!
\@ifundefined{KOMAClassName}{}{
	\@ifundefined{chapter}{}{
		\addtokomafont{partprefix}{\rmfamily}
		\renewcommand*{\partformat}{\color{purple}
			\scalebox{2.5}{\thepart}\enlargethispage{2em}}
		\addtokomafont{chapterprefix}{\raggedleft}
		\RedeclareSectionCommand[beforeskip=0.5em]{chapter}
		\renewcommand*{\chapterformat}{\mbox{%
			\scalebox{1.5}{\chapappifchapterprefix{\nobreakspace}}%
			\scalebox{2.718}{\color{purple}\thechapter}\enskip}}
	}
	\renewcommand*{\sectionformat}%
		{\color{purple}\S\thesection\enskip}
	\renewcommand*{\subsectionformat}%
		{\color{purple}\S\thesubsection\enskip}
	\renewcommand*{\subsubsectionformat}%
		{\color{purple}\S\thesubsubsection\enskip}
	\KOMAoptions{numbers=noenddot}
	%\usetocstyle{KOMAlike}
}


% thm boxes

% theorem, lemma, corollary, proposition

\mdfdefinestyle{mdbluebox}{%
	roundcorner = 10pt,
	linewidth=1pt,
	skipabove=12pt,
	innerbottommargin=9pt,
	skipbelow=2pt,
	linecolor=blue,
	nobreak=true,
	backgroundcolor=TealBlue!5,
}
\declaretheoremstyle[
	headfont=\sffamily\bfseries\color{MidnightBlue},
	mdframed={style=mdbluebox},
	headpunct={\\[3pt]},
	postheadspace={0pt}
]{thmbluebox}

\declaretheorem[style=thmbluebox,name=Theorem,numberwithin=section]{theorem}
\declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
\declaretheorem[style=thmbluebox,name=Proposition,sibling=theorem]{proposition}
\declaretheorem[style=thmbluebox,name=Corollary,numberwithin=theorem]{corollary}

\declaretheorem[style=thmbluebox,name=Theorem,numbered=no]{theorem*}
\declaretheorem[style=thmbluebox,name=Lemma,numbered=no]{lemma*}
\declaretheorem[style=thmbluebox,name=Proposition,numbered=no]{proposition*}
\declaretheorem[style=thmbluebox,name=Corollary,numbered=no]{corollary*}

% Problem, Example

\mdfdefinestyle{mdredbox}{%
	roundcorner = 5pt,
	linewidth=0.5pt,
	skipabove=12pt,
	frametitleaboveskip=5pt,
	frametitlebelowskip=0pt,
	skipbelow=2pt,
	frametitlefont=\bfseries,
	innertopmargin=4pt,
	innerbottommargin=8pt,
	nobreak=true,
	linecolor=purple,
	backgroundcolor=purple!10,
}

\declaretheoremstyle[
	headfont=\sffamily\bfseries\color{purple},
	mdframed={style=mdredbox},
	headpunct={\\[3pt]},
	postheadspace={0pt},
]{thmredbox}

\declaretheorem[style=thmredbox,name=Problem,numberwithin=section]{problem}
\declaretheorem[style=thmredbox,name=Example,sibling=problem]{example}

\declaretheorem[style=thmredbox,name=Problem,numbered=no]{problem*}
\declaretheorem[style=thmredbox,name=Example,numbered=no]{example*}

% Definition, Remark, Claim

\declaretheoremstyle[
	spaceabove=5pt, spacebelow=5pt,
	headfont=\sffamily\bfseries\color{MidnightBlue},
	postheadspace={2pt}
]{plain_blue}

\declaretheoremstyle[
	spaceabove=5pt, spacebelow=5pt,
	headfont=\sffamily\bfseries\color{orange},
	postheadspace={2pt}
]{plain_orange}

\declaretheoremstyle[
	spaceabove=5pt, spacebelow=5pt,
	headfont=\sffamily\bfseries\color{ForestGreen},
	postheadspace={2pt}
]{plain_green}

\declaretheorem[style=plain_orange,name=Definition,numberwithin=section]{definition}
\declaretheorem[style=plain_orange,name=Definition,numbered=no]{definition*}

\declaretheorem[style=plain_green,name=Remark,numbered=no]{remark}
\declaretheorem[style=plain_blue,name=Claim]{claim}

% proof and solution

\renewenvironment{proof}[1][]%
{{\sffamily\bfseries Proof\ifthenelse{\equal{#1}{}}{:}{ #1:}} }%
{{\begin{flushright}$\clubsuit$\end{flushright}}}

\newenvironment{sol}[1][]%
{{\sffamily\bfseries Solution\ifthenelse{\equal{#1}{}}{:}{ #1:}} }%
{{\begin{flushright}$\clubsuit$\end{flushright}}}

% Tricks&Techniques

\definecolor{Cerulean}{rgb}{0.0, 0.48, 0.65}
\definecolor{Capri}{rgb}{0.0, 0.75, 1.0}

\mdfdefinestyle{mdCapribox}{%
	roundcorner = 10pt,
	linewidth=1pt,
	skipabove=12pt,
	innerbottommargin=9pt,
	skipbelow=2pt,
	nobreak=true,
	linecolor=Cerulean,
	backgroundcolor=Capri!10,
}
\declaretheoremstyle[
	headfont=\sffamily\bfseries\color{Capri},
	mdframed={style=mdCapribox},
	headpunct={\\[3pt]},
	postheadspace={0pt},
]{Capribox}

\declaretheorem[style=Capribox,name=Tricks{\&}Techniques,numberwithin=section]{trick}
\declaretheorem[style=Capribox,name=Tricks{\&}Techniques,numbered=no]{trick*}

% code
\newif\ifcode\codefalse
\DeclareOption{code}{\codetrue}
\ProcessOptions\relax

\ifcode
    \usepackage{minted}
    \newminted{pycon}{bgcolor=bg, linenos=true, tabsize =4}
    \setminted[pycon]{autogobble}
    \usepackage{tcolorbox}
    \tcbuselibrary{minted}

    \newtcblisting{tcbcode}[2][]{%
      colback=Black!5,
      listing only,
      minted options={
        mathescape
      },  
      minted language=#2,
      #1
    }

    % mdcode blocks
    \newenvironment{mdcode}%
    {\begin{mdframed}[linecolor=Gray,innerrightmargin=30pt,innerleftmargin=30pt,leftmargin=-30pt,rightmargin=-30pt,backgroundcolor=Black!5,skipabove=10pt,skipbelow=10pt,roundcorner=2pt,splitbottomskip=6pt,splittopskip=12pt]}%
    {\end{mdframed}}
\fi



